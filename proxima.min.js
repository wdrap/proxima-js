/*! proxima-js 2020-04-20 */

!function(){"use strict";var l,s,h,u,v;function c(r){u[0]=r;for(var n=0;n<l.length-1;n++)for(var e=0;e<l[n+1];e++){for(var t=h[n][e],a=0;a<l[n];a++)t+=u[n][a]*s[n][e][a];u[n+1][e]=1/(1+Math.exp(-t))}return u[l.length-1]}function w(r){for(var n=u[u.length-1],e=0,t=0;t<n.length;t++)e+=Math.pow(r[t]-n[t],2);return.5*e}function _(r){for(var n=l.length-1;0<=n;n--)for(var e=0,t=l[n];e<t;e++){var a=0;if(n===l.length-1)a=r[e]-u[n][e];else for(var o=0;o<v[n+1].length;o++)a+=v[n+1][o]*s[n][o][e];v[n][e]=a*u[n][e]*(1-u[n][e])}}function d(r){for(var n=0;n<l.length-1;n++)for(var e=0;e<l[n+1];e++){h[n][e]+=v[n+1][e]*r;for(var t=0;t<l[n];t++)s[n][e][t]+=v[n+1][e]*r*u[n][t]}}function r(o){(o=o||{}).neural_network=o.neural_network||[2,3,1],o.learning_rate=o.learning_rate||.3;var i=o.max_iterations||15e3,f=o.cost_threshold||.005,g=o.log_after_x_iterations||0;return function(r){l=r.neural_network,s=new Array(l.length-2),h=new Array(l.length-2),u=new Array(l.length),v=new Array(l.length-1);for(var n=0,e=l.length;n<e;n++){u[n]=new Array(l[n]),v[n]=new Array(l[n]);for(var t=0,a=l[n];t<a;t++)u[n][t]=0,v[n][t]=0;if(n===e-1)break;h[n]=new Array(l[n+1]),s[n]=new Array(l[n+1]);for(var o=0;o<l[n+1];o++){h[n][o]=2*Math.random()-1,s[n][o]=new Array(l[n]);for(var i=0;i<l[n];i++)s[n][o][i]=2*Math.random()-1}}}(o),{train:function(r){console.time("training");for(var n=1,e=0;e<i&&f<n;e++)for(var t=0,a=r.length;t<a;t++)c(r[t].inputs),n=w(r[t].targets),e%g==0&&console.timeLog("training","error: "+n),f<n&&(_(r[t].targets),d(o.learning_rate));console.timeLog("training","error: "+n,"iterations: "+e),console.timeEnd("training")},predict:function(r){return c(r)},export:function(){return JSON.stringify({nn:l,weights:s,bias_weights:h,gradients:v})},import:function(r){var n=JSON.parse(r);l=n.nn,s=n.weights,h=n.bias_weights,v=n.gradients}}}"undefined"!=typeof exports&&module.exports?module.exports=r:this.Proxima=r}();