/*! proxima-js 2020-04-22 */

!function(){"use strict";var l,s,u,h,v;function c(r){h[0]=r;for(var n=0;n<l.length-1;n++)for(var t=0;t<l[n+1];t++){for(var e=u[n][t],a=0;a<l[n];a++)e+=h[n][a]*s[n][t][a];h[n+1][t]=1/(1+Math.exp(-e))}return h[l.length-1]}function w(r){for(var n=h[h.length-1],t=0,e=0;e<n.length;e++)t+=Math.pow(r[e]-n[e],2);return.5*t}function d(r){for(var n=l.length-1;0<=n;n--)for(var t=0,e=l[n];t<e;t++){var a=0;if(n===l.length-1)a=r[t]-h[n][t];else for(var o=0;o<v[n+1].length;o++)a+=v[n+1][o]*s[n][o][t];v[n][t]=a*h[n][t]*(1-h[n][t])}}function p(r){for(var n=0;n<l.length-1;n++)for(var t=0;t<l[n+1];t++){u[n][t]+=v[n+1][t]*r;for(var e=0;e<l[n];e++)s[n][t][e]+=v[n+1][t]*r*h[n][e]}}function r(a){(a=a||{}).neural_network=a.neural_network||[2,3,1],a.learning_rate=a.learning_rate||.3;var o=a.max_iterations||15e3,i=a.cost_threshold||.005,f=a.log_after_x_iterations||0;!function(r){l=r.neural_network,s=new Array(l.length-2),u=new Array(l.length-2),h=new Array(l.length),v=new Array(l.length-1);for(var n=0,t=l.length;n<t;n++){h[n]=new Array(l[n]),v[n]=new Array(l[n]);for(var e=0,a=l[n];e<a;e++)h[n][e]=0,v[n][e]=0;if(n===t-1)break;u[n]=new Array(l[n+1]),s[n]=new Array(l[n+1]);for(var o=0;o<l[n+1];o++){u[n][o]=2*Math.random()-1,s[n][o]=new Array(l[n]);for(var i=0;i<l[n];i++)s[n][o][i]=2*Math.random()-1}}}(a);var g=1;return{train:function(r){console.time("training");for(var n=0;n<o&&i<g;n++)for(var t=0,e=r.length;t<e;t++)c(r[t].inputs),g=w(r[t].targets),n%f==0&&console.timeLog("training","error: "+g),i<g&&(d(r[t].targets),p(a.learning_rate));console.timeLog("training","error: "+g,"iterations: "+n),console.timeEnd("training")},predict:function(r){var n=c(r);return{output:n,flatten:function(r,n){for(var t=parseFloat(n.toFixed(2)),e=new Array(r.length),a=0;a<r.length;a++)e[a]=r[a]<t/10||r[a]>t?Math.round(r[a]):r[a];return e}(n,g)}},export:function(){return JSON.stringify({nn:l,weights:s,bias_weights:u,gradients:v})},import:function(r){var n=JSON.parse(r);l=n.nn,s=n.weights,u=n.bias_weights,v=n.gradients}}}"undefined"!=typeof exports&&module.exports?module.exports=r:this.Proxima=r}();